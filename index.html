<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Development cache-busting -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <title>LOS App - Last One Standing</title>
    <!-- Cache-busting timestamp: 2025-09-07T22:10:00Z -->
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="images/Logo Round1.png">
    
    <!-- CSS with cache-busting for development -->
    <link rel="stylesheet" href="css/styles.css?v=1.0.1">
    <link rel="stylesheet" href="css/components.css?v=1.0.1">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Skip Link for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h2>Loading LOS App...</h2>
        </div>
    </div>

    <!-- Auth Container -->
    <div id="authContainer" class="auth-container hidden">
        <div class="auth-card">
            <div class="auth-header">
                <img src="images/Logo Round1.png" alt="LOS App Logo" class="auth-logo">
                <h1>Last One Standing</h1>
                <p>Football Prediction Game</p>
            </div>
            
            <!-- Login Form -->
            <form id="loginForm" class="auth-form">
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit" class="btn btn-primary">Sign In</button>
            </form>

            <!-- Register Form -->
            <form id="registerForm" class="auth-form hidden">
                <div class="form-group">
                    <label for="regName">Full Name</label>
                    <input type="text" id="regName" required>
                </div>
                <div class="form-group">
                    <label for="regEmail">Email</label>
                    <input type="email" id="regEmail" required>
                </div>
                <div class="form-group">
                    <label for="regPassword">Password</label>
                    <input type="password" id="regPassword" required>
                </div>
                <div class="form-group">
                    <label for="clubSelect">Select Club</label>
                    <select id="clubSelect" required>
                        <option value="">Choose a club...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editionSelect">Select Edition</label>
                    <select id="editionSelect" required>
                        <option value="">Choose an edition...</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Register</button>
            </form>

            <div class="auth-switch">
                <span id="switchToRegister">Don't have an account? Register</span>
                <span id="switchToLogin" class="hidden">Already have an account? Sign In</span>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="appContainer" class="app-container hidden">
        <!-- Header -->
        <header class="app-header" role="banner">
            <div class="header-content">
                <!-- Left Logo - spans both rows -->
                <img src="images/Logo Round1.png" alt="LOS App Logo" class="header-logo header-logo-left">
                
                <!-- Main Content Area -->
                <div class="header-main">
                    <!-- First Row: Title -->
                    <div class="header-row header-row-top">
                        <h1>Last One Standing</h1>
                    </div>
                    
                    <!-- Second Row: Controls -->
                    <div class="header-row header-row-bottom">
                        <div class="header-controls">
                            <div class="club-selector">
                                <label for="headerClubSelect" class="sr-only">Select Club</label>
                                <select id="headerClubSelect" class="club-select" aria-label="Select Club">
                                    <option value="">Select Club...</option>
                                </select>
                                <label for="headerEditionSelect" class="sr-only">Select Edition</label>
                                <select id="headerEditionSelect" class="edition-select" aria-label="Select Edition">
                                    <option value="">Select Edition...</option>
                                </select>
                            </div>
                            <div class="user-info">
                                <span id="userName" aria-label="Current user">Player</span>
                                <div id="userLives" class="lives-indicator" aria-label="User lives remaining">
                                    <!-- Lives will be populated by JavaScript -->
                                </div>
                            </div>
                            <!-- Admin and Super Admin buttons will be inserted here by JavaScript -->
                            <div id="adminButtonsContainer"></div>
                            <!-- Connection Status Indicator - Hidden by default, shown only when needed -->
                            <div id="connectionStatus" class="connection-status hidden" role="status" aria-live="polite">
                                <i class="fas fa-circle" aria-hidden="true"></i>
                                <span id="connectionText">Connecting...</span>
                            </div>
                            <!-- Refresh button - Hidden by default, shown only when needed -->
                            <button id="resetConnectionBtn" class="btn btn-warning btn-sm hidden" 
                                    title="Reset Firebase Connection" 
                                    aria-label="Reset Firebase Connection">
                                <i class="fas fa-sync-alt" aria-hidden="true"></i>
                            </button>
                            <button id="logoutBtn" class="btn btn-secondary" 
                                    title="Logout" 
                                    aria-label="Logout">
                                <i class="fas fa-sign-out-alt" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Right Logo - spans both rows -->
                <img src="images/Logo Round1.png" alt="LOS App Logo" class="header-logo header-logo-right">
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="app-nav" role="navigation" aria-label="Main navigation">
            <div class="nav-tabs" role="tablist">
                <button class="nav-tab active" data-tab="fixtures" role="tab" aria-selected="true" aria-controls="fixturesTab">
                    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                    <span>Fixtures</span>
                </button>
                <button class="nav-tab" data-tab="picks" role="tab" aria-selected="false" aria-controls="picksTab">
                    <i class="fas fa-list-check" aria-hidden="true"></i>
                    <span>My Picks</span>
                </button>
                <button class="nav-tab" data-tab="standings" role="tab" aria-selected="false" aria-controls="standingsTab">
                    <i class="fas fa-trophy" aria-hidden="true"></i>
                    <span>As It Stands</span>
                </button>
                <button class="nav-tab" data-tab="scores" role="tab" aria-selected="false" aria-controls="scoresTab">
                    <i class="fas fa-futbol" aria-hidden="true"></i>
                    <span>Scores</span>
                </button>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main id="main-content" class="app-main" role="main">
            <!-- Fixtures Tab -->
            <div id="fixturesTab" class="tab-content active" role="tabpanel" aria-labelledby="fixtures-tab">
                <div class="tab-header">
                    <div class="tab-header-left">
                        <h2>Gameweek <span id="currentGameweek">1</span> Fixtures</h2>
                        <div class="deadline-info">
                            <i class="fas fa-clock" aria-hidden="true"></i>
                            <span id="deadlineText">Deadline: Loading...</span>
                        </div>
                    </div>
                    <div class="tab-header-right">
                        <div class="gameweek-navigation">
                            <button id="prevGameweek" class="btn btn-secondary btn-sm" 
                                    title="Previous Gameweek" 
                                    aria-label="Previous Gameweek">
                                <i class="fas fa-chevron-left" aria-hidden="true"></i>
                            </button>
                            <label for="gameweekSelect" class="sr-only">Select Gameweek</label>
                            <select id="gameweekSelect" class="gameweek-select" aria-label="Select Gameweek">
                                <option value="1">Gameweek 1</option>
                                <option value="2">Gameweek 2</option>
                                <option value="3">Gameweek 3</option>
                                <option value="4">Gameweek 4</option>
                                <option value="5">Gameweek 5</option>
                                <option value="6">Gameweek 6</option>
                                <option value="7">Gameweek 7</option>
                                <option value="8">Gameweek 8</option>
                                <option value="9">Gameweek 9</option>
                                <option value="10">Gameweek 10</option>
                            </select>
                            <button id="nextGameweek" class="btn btn-secondary btn-sm" 
                                    title="Next Gameweek" 
                                    aria-label="Next Gameweek">
                                <i class="fas fa-chevron-right" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="fixturesList" class="fixtures-list" role="region" aria-label="Fixtures list">
                    <!-- Loading state for fixtures -->
                    <div id="fixturesLoading" class="loading-state" role="status" aria-live="polite">
                        <div class="loading-spinner-small" aria-hidden="true"></div>
                        <p>Loading fixtures...</p>
                    </div>
                    <!-- Fixtures will be loaded here -->
                </div>
            </div>

            <!-- My Picks Tab -->
            <div id="picksTab" class="tab-content">
                <div class="tab-header">
                    <h2>My Pick History</h2>
                </div>
                <div id="picksList" class="picks-list">
                    <!-- Loading state for picks -->
                    <div id="picksLoading" class="loading-state">
                        <div class="loading-spinner-small"></div>
                        <p>Loading pick history...</p>
                    </div>
                    <!-- Pick history will be loaded here -->
                </div>
            </div>

            <!-- Standings Tab -->
            <div id="standingsTab" class="tab-content">
                <div class="tab-header">
                    <h2>As It Stands</h2>
                </div>
                <div id="standingsList" class="standings-list">
                    <!-- Loading state for standings -->
                    <div id="standingsLoading" class="loading-state">
                        <div class="loading-spinner-small"></div>
                        <p>Loading standings...</p>
                    </div>
                    <!-- Standings will be loaded here -->
                </div>
            </div>

            <!-- Scores Tab -->
            <div id="scoresTab" class="tab-content">
                <div class="tab-header">
                    <h2>Live Scores</h2>
                </div>
                <div id="scoresList" class="scores-list">
                    <!-- Loading state for scores -->
                    <div id="scoresLoading" class="loading-state">
                        <div class="loading-spinner-small"></div>
                        <p>Loading scores...</p>
                    </div>
                    <!-- Live scores will be loaded here -->
                </div>
            </div>
        </main>
    </div>

    <!-- Admin Panel (Hidden by default) -->
    <div id="adminPanel" class="admin-panel hidden">
        <div class="admin-header">
            <h2>Admin Panel</h2>
            <button id="closeAdmin" class="btn btn-secondary">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="admin-content">
            <div class="admin-tabs">
                <button class="admin-tab active" data-admin-tab="users">Users</button>
                <button class="admin-tab" data-admin-tab="fixtures">Fixtures</button>
                <button class="admin-tab" data-admin-tab="scores">Scores</button>
                <button class="admin-tab" data-admin-tab="settings">Settings</button>
            </div>
            <div id="adminContent" class="admin-content-area">
                <!-- Admin content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="pickModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirm Your Pick</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to pick <strong id="pickTeamName"></strong>?</p>
                <p class="warning">This pick cannot be changed after the deadline!</p>
            </div>
            <div class="modal-footer">
                <button id="confirmPick" class="btn btn-primary">Confirm Pick</button>
                <button id="cancelPick" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Error Toast Notification -->
    <div id="errorToast" class="toast toast-error hidden">
        <div class="toast-content">
            <i class="fas fa-exclamation-triangle"></i>
            <span id="errorMessage">An error occurred</span>
        </div>
        <button class="toast-close">&times;</button>
    </div>

    <!-- Success Toast Notification -->
    <div id="successToast" class="toast toast-success hidden">
        <div class="toast-content">
            <i class="fas fa-check-circle"></i>
            <span id="successMessage">Operation completed successfully</span>
        </div>
        <button class="toast-close">&times;</button>
    </div>

    <!-- Info Toast Notification -->
    <div id="infoToast" class="toast toast-info hidden">
        <div class="toast-content">
            <i class="fas fa-info-circle"></i>
            <span id="infoMessage">Information message</span>
        </div>
        <button class="toast-close">&times;</button>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>

    <!-- Main App Module Entry Point -->
    <script type="module" src="/js/app.js"></script>
</body>
</html>
